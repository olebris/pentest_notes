---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# ðŸ”„ Reconnaissance

Scan rapide (pingsweep) d'un rÃ©seau entier:

```
sudo nmap -sn 192.168.0.0/24 
```

Ajout d'un TCP Syn pour contourner Windows firewall qui bloque ICMP

```
sudo nmap -sn -PS21,22,23,25,80,139,443,445,3389,8080 192.168.0.0/24
```



## NMAP (Port scan)

Reconnaissance  des ports TCP ouverts (-sU pour UDP)&#x20;

<pre><code><strong>sudo nmap -sS -p- -T4 $IP
</strong></code></pre>

Service dÃ©tection des ports trouvÃ©s prÃ©cÃ©demment

```
sudo nmap -sS -sV --version-intensity=8 -p21,80 -T4 $IP
```

Recherche OS + Scripts par dÃ©faut&#x20;

```
sudo nmap -sS -sV -O -sC --version-intensity=8 -p21,80 -T4 $IP
```

Mode agressif ( -sV ,-sC ,-O , traceroute)  &#x20;

```
sudo nmap -sS â€“A -T5 -Pn $IP
```

* _Ajout de `-Pn` si ICMP bloquÃ©. -T5 pour timing ++_

Vulnerabilities search:

```
nmap -sV -sC -oN nmap-report.txt --script=vuln $IP
```

FW & IDS evasion

```
sudo nmap -Pn -sS -sV -p21,80 -f --data-length 200 -g 53 -D IP-spoof1,IP-spoof2 $IP  
```

* \-f : fragmente les packets (en general 8 bis, peut Ãªtre forcÃ© avec -- mtu)
* \--data-length : assure que les paquets sont assez gros pour Ãªtre fragmentÃ©s
* \-D : spoofing d'adresse IP Ã©mettrice
* \-g force le port dâ€™Ã©mission&#x20;

&#x20;Scripts&#x20;

{% embed url="https://nmap.org/book/nse-usage.html" %}

## Metasploit (network scan)

```

se auxiliary/scanner/portscan/tcp
```

## URL discovery

### Gobuster (Directory discovery)

{% code overflow="wrap" %}
```
gobuster dir -u http://10.10.232.151 -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt -x php,html,txt,htm,log
```
{% endcode %}

{% code overflow="wrap" %}
```
gobuster dir -u https://example.com -w /wordlists/Discovery/Web-Content/big.txt -t 4 --delay 1s
```
{% endcode %}

* _NB: chercher des fichier => ajouter_ `â€“x php,txt,html`
* _NB2: relancer gobuster sur les rÃ©pertoires trouvÃ©s Ã  la racine (pour rÃ©cursivitÃ© !)_
* Pour trouver les sous domaines utiliser vhost ou dns:

### Gobuster DNS (DNS enumeration)

{% code overflow="wrap" %}
```
$ gobuster dns -q -r 8.8.8.8 -d example.com -w wordlists/Discovery/DNS/subdomains-top1million-5000.txt -t 4 --delay 1s -o results.txt"	
```
{% endcode %}

### Gobuster vhost (sous domaine sur un mÃªme host)

{% code overflow="wrap" %}
```
gobuster vhost -u https://example.com -t 50 -w /wordlists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
```
{% endcode %}

* NB: ne pas oublier le append domain pour faire sousdomaine.domaine.tld !!!

{% embed url="https://www.kali-linux.fr/conseil/gobuster-le-bruteforce-de-pages-web" %}

* Autres Outils
  * &#x20;OWASP ZAP - brute force directory (plus lent que gobuster ...)
  * Burp: `Intruder`
  * Metasploit: `modules/auxiliary/scanner/http/dir_scanner.rb`
  * Nikto
  * dirb / dirbuster (rÃ©cursif!)  /ffuf (rÃ©cursif + fuzzing de host )&#x20;

```
ffuf -w ~/wordlists/common.txt -recursion -u http://ffuf.me/cd/recursion/FUZZ
```

## VULN Scan

```
nikto -h $IP
```

* OWASP ZAP (use active scan)
* Enum4linux

```
enum4linux $IP | tee report.txt 
```

* Metasploit

```
use auxiliary/scanner/portscan/tcp
```

## Manual web discovery&#x20;

* Essayer _/admin /sitemap/ /login /mail / phpinfo /content â€¦_
* Inspecter code source&#x20;
* Robots.txt&#x20;
* Sitemap.xml&#x20;
* Favicon search (compare md5) => [https://wiki.owasp.org/index.php/OWASP\_favicon\_database](https://wiki.owasp.org/index.php/OWASP\_favicon\_database)&#x20;

```
curl https://mysite.com/sites/favicon/images/favicon.ico | md5sum 
```

* [https://www.wappalyzer.com/](https://www.wappalyzer.com/) &#x20;
* Wayback machine &#x20;
* Headers http&#x20;

&#x20;

## Google Dorking&#x20;

| <p>Filter <br> </p>   | <p>Example <br> </p>            | <p>Description <br> </p>                                                                                  |
| --------------------- | ------------------------------- | --------------------------------------------------------------------------------------------------------- |
| <p>site <br> </p>     | <p>site:tryhackme.com <br> </p> | <p>returns results only from the specified website address </p><p>*.example.com shows subdomains<br> </p> |
| <p>inurl <br> </p>    | <p>inurl:admin <br> </p>        | <p>returns results that have the specified word in the URL <br> </p>                                      |
| <p>filetype <br> </p> | <p>filetype:pdf <br> </p>       | <p>returns results which are a particular file extension <br> </p>                                        |
| <p>intitle <br> </p>  | <p>intitle:admin <br> </p>      | returns results that contain the specified word in the title                                              |

{% embed url="https://www.exploit-db.com/google-hacking-database" %}

## DNS

* dig / whois / nslookup
* https://dnsdumpster.com/ (Ã©numÃ©ration des sous domaines )
* https://asnlookup.com/
* https://www.shodan.io/

```
amass enum -d example.com
```

## TECHNOLOGIES

Add-ons : Wappalyzer / BuiltWith

Whatweb

```
whatweb example.com
```

Netcraft Tools\
[https://sitereport.netcraft.com/](https://sitereport.netcraft.com/)

WAF dÃ©tection (wafw00f)

```
wafw00f example.fr
```

